<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Prachi's Resume Q&A</title>
        <style>
            body {
                font-family: Arial, sans-serif;
                padding: 20px;
                max-width: 400px;
                margin: auto;
            }
            #question {
                width: 100%;
                padding: 8px;
                margin-bottom: 10px;
            }
            #askBtn {
                padding: 8px 16px;
                cursor: pointer;
            }
            #answer {
                margin-top: 15px;
                padding: 10px;
                border: 1px solid #ddd;
                min-height: 50px;
            }
        </style>
    </head>
    <body>
        <h3>Ask me about Prachi's experience!</h3>
        <div id="note">
            Psst... I might be stretching after a nap â€” give me ~30 sec to wake up!
        </div>
        <input type="text" id="question" placeholder="Ask me anything about my resume..."/>
        <button id="askBtn">Ask</button>
        <div id="answer"></div>

        <script>
            // Debug: confirm script is loaded
            console.log("Chat widget script loaded");

            //Wait for page load
            window.onload = function() {
                const btn = document.getElementById('askBtn');
                const note = document.getElementById('note');
                btn.addEventListener('click', async function() {
                    const q = document.getElementById('question').value;
                    document.getElementById('answer').innerText = "Thinking...";
                    try {
                        const res = await fetch("https://resume-agent-833q.onrender.com/ask", {
                        method: "POST",
                        headers: {"Content-Type": "application/json"},
                        body: JSON.stringify({question: q})
                    });
                    if (!res.ok) throw new Error("HTTP " + res.status);
                    const data = await res.json();
                    document.getElementById('answer').innerText = data.answer || data.error || "No response";

                    // Hide the wake-up note after first successful response
                    if (!note.classList.contains('hidden')) {
                        note.classList.add('hidden');
                    }
                        
                } catch (e) {
                    document.getElementById('answer').innerText = "Error: " + e.message;
                }
            });
        };
        </script>
    </body>
</html>
